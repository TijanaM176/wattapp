<ngx-spinner
  bdColor="rgba(0, 0, 0, 0.95)"
  size="small"
  color="#fff"
  type="ball-clip-rotate"
  [showSpinner]="true"
  [fullScreen]="true"
  [zIndex]="9999"
  ><p style="font-size: 25px; color: white">Loading Data...</p></ngx-spinner
>

<section class="mx-0 my-0 px-0 py-0" style="background-color: #f4f5f7">
  <div class="container-fluid h-100 px-0 py-0 mx-0 my-0">
    <div
      class="row d-flex justify-content-center align-items-start align-items-md-center mx-0 my-0 px-0 py-0 h-100"
    >
      <div class="col px-0 mx-0 my-0 py-0 h-100">
        <div class="card h-md-100" style="border-radius: 0">
          <div
            class="row g-0 h-md-100 justify-content-center align-items-start align-items-md-center px-0 py-0"
          >
            <div
              class="col-md-6 justify-content-center align-items-center h-md-100 order-1 order-md-1 mx-0 my-0 px-0 py-0"
            >
              <div
                class="card-body"
                style="width: 80%; margin: 0 auto"
                id="consumptionLimitCardBody"
              >
                <div
                  class="w-80 px-0 py-0 mx-0 my-0"
                  style="
                    display: flex;
                    justify-content: center;
                    align-items: center;
                  "
                  id="consumptionLimitBody"
                >
                  <ngx-gauge
                    class="text-size"
                    [type]="'semi'"
                    [size]="width"
                    [label]="gaugeLabel"
                    [append]="gaugeAppendText"
                    [min]="0"
                    [max]="maxUsageNumber"
                    [markers]="markers"
                    [value]="currentUsage"
                    [valueFormatting]="formatValue"
                    [cap]="'butt'"
                    [thick]="35"
                    [thresholds]="thresholds"
                  >
                  </ngx-gauge>
                </div>
                <div class="legend w-100 text-center">
                  <i class="fa fa-circle greenZone"
                    >&nbsp;0-{{ AvgUsage }} kWh</i
                  >&nbsp;&nbsp;&nbsp;
                  <i class="fa fa-circle blueZone"
                    >&nbsp; {{ AvgUsage }}-{{ MaxUsage }} kWh</i
                  >&nbsp;&nbsp;&nbsp;
                  <i class="fa fa-circle redZone">&nbsp;{{ MaxUsage }}+ kWh</i>
                </div>
              </div>

              <div class="card-body p-1 p-md-4">
                <br />
                <div style="display: flex; justify-content: space-between">
                  <h6 class="section">Device Information</h6>
                  <div *ngIf="currentUsage == 0" (click)="toggle()">
                    <i class="fa fa-power-off fa-lg off"></i>&nbsp;Turn On
                  </div>
                  <div *ngIf="currentUsage != 0" (click)="toggle()">
                    <i class="fa fa-power-off fa-lg on"></i>&nbsp;Turn Off
                  </div>
                </div>
                <hr class="mt-0 mb-3" />
                <div class="row pt-1 mx-0 my-0 text-center">
                  <div class="col-6 mb-1">
                    <h6 style="color: #08376b">{{ IpAddress }}</h6>
                    <p class="text-muted">IP Address</p>
                  </div>
                  <div class="col-6 mb-1">
                    <h6 style="color: #08376b">{{ TypeName }}</h6>
                    <p class="text-muted">Device Type</p>
                  </div>
                </div>
                <hr class="mt-0 mb-3" />
                <div class="row pt-1 mx-0 my-0 text-center">
                  <div class="col-6 mb-1">
                    <h6 style="color: #08376b">{{ ModelName }}</h6>
                    <p class="text-muted">Device Model</p>
                  </div>
                  <div class="col-6 mb-1">
                    <h6 style="color: #08376b">{{ Name }}</h6>
                    <p class="text-muted">Device Name</p>
                  </div>
                </div>
                <hr class="mt-0 mb-3" />

                <div class="row pt-1 mx-0 my-0 text-center">
                  <div class="col-6 mb-1">
                    <h6 style="color: #08376b">{{ MaxUsage }}kWh</h6>
                    <p class="text-muted">Maximum hourly consumption</p>
                  </div>
                  <div class="col-6 mb-1">
                    <h6 style="color: #08376b">{{ AvgUsage }}kWh</h6>
                    <p class="text-muted">Average hourly consumption</p>
                  </div>
                </div>
                <div class="row pt-1 mx-0 my-0">
                  <mat-slide-toggle [(ngModel)]="DsoView"
                    >Allow DSO to view</mat-slide-toggle
                  >
                  <mat-slide-toggle [(ngModel)]="DsoControl"
                    >Allow DSO to control</mat-slide-toggle
                  >
                  <br />
                </div>
                <div></div>
                <div
                  class="d-flex justify-content-start"
                  style="margin-top: 5%; margin-bottom: 3%; padding-left: 4%"
                >
                  <button
                    class="btn btn-primary"
                    (click)="edit()"
                    data-bs-toggle="modal"
                    data-bs-target="#staticBackdrop"
                  >
                    <i
                      class="fa fa-edit fa-lg"
                      data-bs-toggle="modal"
                      data-bs-target="#staticBackdrop"
                      (click)="edit()"
                    ></i
                    >&nbsp;Edit
                  </button>
                  &nbsp;&nbsp;
                  <button class="btn btn-primary" (click)="delete(idDev)">
                    <i class="fa fa-trash fa-lg"></i>&nbsp;Delete</button
                  >&nbsp;&nbsp;
                </div>
              </div>
            </div>

            <div
              class="col-md-6 gradient-custom d-flex flex-column align-items-center h-md-100 order-2 order-md-2"
            >
              <app-realizationDevice
                [type]="gaugeLabel"
                class="w-100"
              ></app-realizationDevice>
              <app-predictionDevice
                [type]="gaugeLabel"
                class="w-100"
              ></app-predictionDevice>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<app-add-device></app-add-device>
<div
  class="modal fade"
  id="staticBackdrop"
  data-bs-backdrop="static"
  data-bs-keyboard="false"
  tabindex="-1"
  aria-labelledby="staticBackdropLabel"
  aria-hidden="true"
>
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header text-white" style="background-color: #466471">
        <h5 class="modal-title" id="staticBackdropLabel">{{ modalTitle }}</h5>
        <button
          type="button"
          class="btn-close"
          data-bs-dismiss="modal"
          aria-label="Close"
          (click)="close()"
        ></button>
      </div>
      <div class="modal-body">
        <app-edit-device-form
          [deviceData]="deviceData"
          *ngIf="showEdit == true"
          #editData
        ></app-edit-device-form>
      </div>
      <div class="modal-footer">
        <button
          type="button"
          class="btn btn-secondary"
          data-bs-dismiss="modal"
          (click)="close()"
        >
          Close
        </button>
        <button type="button" class="btn btn-primary" (click)="confirm()">
          Confirm
        </button>
      </div>
    </div>
  </div>
</div>
