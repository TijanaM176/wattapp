<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round"
/>
<link
  rel="stylesheet"
  href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/css/bootstrap.min.css"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/icon?family=Material+Icons"
/>
<link
  rel="stylesheet"
  href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"
/>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.0/js/bootstrap.min.js"></script>

<div class="container-xl">
  <div class="table-responsive">
    <div class="table-wrapper">
      <h1 style="text-align: center; margin-bottom: 3%">User Devices</h1>
      <div class="table-title">
        <div class="row">
          <div class="col-sm-2" style="padding-top: 0.7%">
            <div class="search-box" style="margin-right: 1%">
              <div class="input-group">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value="1"
                    (change)="filterDevices()"
                    id="flexCheckDefault"
                    [(ngModel)]="showConsumers"
                  />
                  <label class="form-check-label" for="flexCheckDefault">
                    Consumers
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-2" style="padding-top: 0.7%">
            <div class="search-box" style="margin-right: 1%">
              <div class="input-group">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value="2"
                    id="flexCheckDefaul1"
                    (change)="filterDevices()"
                    [(ngModel)]="showProducers"
                  />
                  <label class="form-check-label" for="flexCheckDefaul1">
                    Producers
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-2" style="padding-top: 0.7%">
            <div class="search-box" style="margin-right: 1%">
              <div class="input-group">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    value="3"
                    [(ngModel)]="showStorages"
                    id="flexCheckDefault2"
                    (change)="filterDevices()"
                  />
                  <label class="form-check-label" for="flexCheckDefault2">
                    Storages
                  </label>
                </div>
              </div>
            </div>
          </div>
          <div class="col-sm-3" style="margin-left: 25%">
            <div class="search-box" style="margin-right: 1%">
              <div class="input-group">
                <span class="input-group-addon" style="margin-right: 2%"
                  ><i class="material-icons" style="margin-right: 2%"
                    >î¢¶</i
                  ></span
                >
                <input
                  [(ngModel)]="searchName"
                  type="text"
                  (input)="filterDevices()"
                  style="background-color: #f8f8fa; border-radius: 10px"
                  class="form-control"
                  placeholder="By Device Name"
                />
              </div>
            </div>
          </div>
        </div>
      </div>
      <table class="table table-bordered">
        <thead>
          <tr>
            <th></th>
            <th>IP Address<i class="fa fa-sort"></i></th>
            <th>Device Name<i class="fa fa-sort"></i></th>

            <th>Energy <i class="fa fa-sort"></i></th>
            <th>Activity</th>
            <th></th>
          </tr>
        </thead>
        <tbody
          *ngFor="
            let device of devicesToShow
              | slice
                : (currentPage - 1) * itemsPerPage
                : currentPage * itemsPerPage
          "
        >
          <tr>
            <td [ngSwitch]="device.typeId">
              <span *ngSwitchCase="'1'"
                ><i class="fa fa-refrigerator"></i
              ></span>
              <span *ngSwitchCase="'2'"><i class="fa fa-tv"></i></span>
              <span *ngSwitchCase="'3'"><i class="fa fa-oven"></i></span>
              <span *ngSwitchCase="'4'"><i class="fa fa-ac"></i></span>
              <span *ngSwitchCase="'8'"><i class="fa fa-laptop"></i></span>
            </td>
            <td>{{ device.ipAddress }}</td>
            <td>{{ device.name }}</td>

            <td>{{ device.wattage }}kW</td>
            <td>
              <div *ngIf="'consumer.wattage' !== value; else offToggle">
                <div class="form-check form-switch">
                  <input
                    class="form-check-input"
                    checked
                    type="checkbox"
                    role="switch"
                    id="flexSwitchCheckDefault"
                  />
                  <label class="form-check-label" for="flexSwitchCheckDefault"
                    >On</label
                  >
                </div>
              </div>
              <ng-template #offToggle>
                <div class="form-check form-switch">
                  <input
                    class="form-check-input"
                    checked
                    type="checkbox"
                    role="switch"
                    id="flexSwitchCheckDefault"
                  />
                  <label class="form-check-label" for="flexSwitchCheckDefault"
                    >On</label
                  >
                </div>
              </ng-template>
            </td>
            <td><a
              routerLink="/user/{{id}}/Devices/deviceinfo/{{device.id}}"
              class="settings"
              title=""
              ><i class="fa fa-info-circle"></i></a
            ></td>
          </tr>
        </tbody>
      </table>

      <div class="pagination">
        <button
          [disabled]="currentPage == 1 || currentPage == 0"
          (click)="currentPage = currentPage - 1"
        >
          Previous
        </button>
        <button
          *ngFor="let page of pages"
          [class.active]="currentPage == page"
          (click)="currentPage = page"
        >
          {{ page }}
        </button>
        <button
          [disabled]="currentPage == pages.length || pages.length === 0"
          (click)="currentPage = currentPage + 1"
        >
          Next
        </button>
      </div>
    </div>
  </div>
</div>
